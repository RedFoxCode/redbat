"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _typeof2=require("babel-runtime/helpers/typeof"),_typeof3=_interopRequireDefault(_typeof2),_promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise);!function(e,t){function n(t,r){if("."!=t[0]&&"/"!=t[0])return e(t);r=r||"root";var i=n.resolve(t);if(!i&&/\.json$/i.test(t))return e("./"+n.basename(t));var s=n.cache[i];if(!s)try{return e(t)}catch(e){throw new Error('failed to require "'+t+'" from '+r+"\n"+e.message+"\n"+e.stack)}return s.exports||(s.exports={},s.call(s.exports,s,s.exports,n.relative(i))),s.exports}n.cache={},n.basename=e("path").basename,n.resolve=function(t){if("."!=t[0])return e.resolve(t);var r="/"===t.slice(-1)?t:t+"/",i=[t,t+".js",r+"index.js",t+".json",r+"index.json"];for(var s in i){var o=i[s];if(n.cache[o])return o}},n.register=function(e,t){n.cache[e]=t},n.relative=function(e){function t(t){if("."!=t[0])return n(t);var r=e.split("/"),i=t.split("/");r.pop();for(var s in i){var o=i[s];".."==o?r.pop():"."!=o&&r.push(o)}return n(r.join("/"),e)}return t.resolve=n.resolve,t.cache=n.cache,t},n.register("./eventemitter.js",function(e,t,n){var r=n("./namespace"),i=n("lodash");e.exports=function(){this.DEFAULT_NAMESPACE="default",this.namespaces={},this.connected=[],this.namespaces[this.DEFAULT_NAMESPACE]=new r,this.namespace=function(e){return e?this.namespaces[e]?this.namespaces[e]:this.namespaces[e]=new r:this.namespaces[this.DEFAULT_NAMESPACE]};var e=this.namespace();return this.on=e.on,this.onFast=function(t,n){return e._on()},this.once=e.once,this.onceFast=function(t,n){return e._on(t,null,!0,n)},this.wait=e.wait,this.emit=function(){var t=arguments;return this.connected.length&&i.each(this.connected,function(e){return e.emit.apply(e,t)}),e.emit.apply(this,arguments)},this.use=e.use,this.listener=e.getListeners,this.pipe=function(e){this.connected.push(e)},this}}),n.register("./generator.js",function(e,t,n){var r=n("./eventemitter"),i=n("lodash");e.exports=function(){var e=this;this.methods={},this.Generator=function(){var t=this;r.apply(this),i.each(i.keys(e.methods),function(n){if(t[n])throw new Error("Method '"+n+"' already exists");t[n]=e.methods[n]})}}}),n.register("./index.js",function(e,t,n){var r=n("./eventemitter"),i=n("./generator");e.exports={EventEmitter:r,Generator:i}}),n.register("./namespace.js",function(e,t,n){var r=n("overload-js"),i=n("async"),s=n("lodash"),o=r.o;e.exports=function(){var e=this;return this.listeners=[],this.middlewares=[],this._on=function(t,n,r,i){var o,a=!i;a&&(i=function(){o(s.slice(arguments))});var u={type:t,ttl:n?n+Date.now():null,handler:i,once:r};return e.listeners.push(u),a?new _promise2.default(function(t,n){o=function(n){t.apply(e,n)}}):e},this.on=r().args(o.any(String,Array),Function).use(function(t,n){return e._on(t,0,!1,n)}).args(o.any(String,Array),Number,Function).use(function(t,n,r){return e._on(t,n,!1,r)}),this.once=r().args(o.any(String,Array),Function).use(function(t,n){return e._on(t,0,!0,n)}).args(o.any(String,Array),Number,Function).use(function(t,n,r){return e._on(t,n,!0,r)}),this.wait=function(t,n){return e._on(t,n,!0,void 0)},this.emit=function(t){var n=s.slice(arguments,1);return e.executeMiddlewares(t,n,function(){e.executeListeners(t,n)}),e},this.use=function(t){return e.middlewares.push(t),e},this.getListeners=function(t){return s.filter(e.listeners,function(n,r){return!!n&&(n.once&&e.listeners.splice(r,1),!n.ttl&&n.type===t||(n.ttl&&n.ttl<Date.now()?(e.listeners.splice(r,1),!1):"object"===(0,_typeof3.default)(n.type)?-1!==s.indexOf(n.type,t):n.type===t))})},this.executeListeners=function(t,n,r){var o=e.getListeners(t),a=o.length>1;if(!o.length)return r();if(a)i.eachSeries(o,function(e){e.handler.apply(e,s.concat(n,function(e){r(e||null)}))},function(e){if(e)throw e});else{if(!n.length||1===n.length)return o[0].handler(n[0]);o[0].handler.apply(o[0],n)}},this.executeMiddlewares=function(t,n,r){if(!e.middlewares.length)return r();i.eachSeries(e.middlewares,function(r,i){var s=function(e){i(e||null)},o=[t,n,r.length>2?s:void 0];r.apply(e,o),2===r.length&&s()},r)},this}}),t.exports=n("./index.js")}(require,module);