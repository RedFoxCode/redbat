"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _typeof2=require("babel-runtime/helpers/typeof"),_typeof3=_interopRequireDefault(_typeof2),_promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise);!function(e,t){function n(t,i){if("."!=t[0]&&"/"!=t[0])return e(t);i=i||"root";var s=n.resolve(t);if(!s&&/\.json$/i.test(t))return e("./"+n.basename(t));var r=n.cache[s];if(!r)try{return e(t)}catch(e){throw new Error('failed to require "'+t+'" from '+i+"\n"+e.message+"\n"+e.stack)}return r.exports||(r.exports={},r.call(r.exports,r,r.exports,n.relative(s))),r.exports}n.cache={},n.basename=e("path").basename,n.resolve=function(t){if("."!=t[0])return e.resolve(t);var i="/"===t.slice(-1)?t:t+"/",s=[t,t+".js",i+"index.js",t+".json",i+"index.json"];for(var r in s){var a=s[r];if(n.cache[a])return a}},n.register=function(e,t){n.cache[e]=t},n.relative=function(e){function t(t){if("."!=t[0])return n(t);var i=e.split("/"),s=t.split("/");i.pop();for(var r in s){var a=s[r];".."==a?i.pop():"."!=a&&i.push(a)}return n(i.join("/"),e)}return t.resolve=n.resolve,t.cache=n.cache,t},n.register("./eventemitter.js",function(e,t,n){var i=n("./namespace"),s=n("lodash");e.exports=function(e){var t=this;e=s.defaults(e,{fast:!1,defaultNamespace:"default",id:Math.random()}),this._id=e.id,this.namespaces={},this.namespaces[e.defaultNamespace]=new i(this._id,t),this.namespace=function(n){return n?this.namespaces[n]?this.namespaces[n]:this.namespaces[n]=new i(null,t):this.namespaces[e.defaultNamespace]};var n=this.namespace();return this.on=n.on,this.onFast=n.onFast,this.once=n.once,this.onceFast=n.onceFast,this.wait=n.wait,this.emit=n.emit,this.emitFast=n.emitFast,this.use=n.use,this.listener=n.getListeners,this.pipe=n.pipe,this.unpipe=n.unpipe,e.fast&&(delete this.on,delete this.use,delete this.once,delete this.emit,delete this.pipe,this.on=this.onFast,this.once=this.onceFast,this.emit=this.emitFast),this}}),n.register("./generator.js",function(e,t,n){var i=n("./eventemitter"),s=n("lodash");e.exports=function(){var e=this;this.methods={},this.Generator=function(){var t=this;i.apply(this),s.each(s.keys(e.methods),function(n){if(t[n])throw new Error("Method '"+n+"' already exists");t[n]=e.methods[n]})}}}),n.register("./index.js",function(e,t,n){var i=n("./eventemitter"),s=n("./generator");e.exports={EventEmitter:i,Generator:s}}),n.register("./namespace.js",function(e,t,n){var i=n("overload-js"),s=n("async"),r=n("lodash"),a=i.o;e.exports=Namespace=function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}(function(e,t){var n=this;return this.listeners=[],this.middlewares=[],this.connected=[],this._id=e||Math.random(),this._on=function(e,t,i,s){var a,o=!s;o&&(s=function(){a(r.slice(arguments))});var c={type:e,ttl:t?t+Date.now():null,handler:s,once:i};return n.listeners.push(c),o?new _promise2.default(function(e,t){a=function(t){e.apply(n,t)}}):n},this.on=i().args(a.any(String,Array),Function).use(function(e,t){return n._on(e,0,!1,t)}).args(a.any(String,Array),Number,Function).use(function(e,t,i){return n._on(e,t,!1,i)}),this.once=i().args(a.any(String,Array),Function).use(function(e,t){return n._on(e,0,!0,t)}).args(a.any(String,Array),Number,Function).use(function(e,t,i){return n._on(e,t,!0,i)}),this.wait=function(e,t){return n._on(e,t,!0,void 0)},this.delete=function(e){return n.getListeners(e,!0),n},this.pipe=function(){return[].push.apply(n.connected,n.namespacifyAll(arguments)),n},this.unpipe=function(e){e=n.namespacify(e),r.each(n.connected,function(t,i){t._id===e._id&&n.connected.splice(i,1)})},this.onFast=function(e,t){return n.listeners.push({type:e,handler:t}),n},this.onceFast=function(e,t){return n.listeners.push({type:e,handler:t,once:!0}),n},this.emit=function(e){var t=r.slice(arguments),i=r.slice(t,1);return r.each(n.connected,function(e){return e&&e.emit.apply(e.namespace?e.namespace():e,t)}),n.executeMiddlewares(e,i,function(){n.executeListeners(e,i)}),n},this.emitFast=function(e){var t=r.slice(arguments,1);r.each(n.listeners,function(i){("string"==typeof i.type?i.type===e:-1!==r.indexOf(i.type,e))&&i.handler.apply(n,t)})},this.use=function(e){return n.middlewares.push(e),n},this.getListeners=function(e,t){return r.filter(n.listeners,function(i,s){if(!i)return!1;if(i.once&&n.listeners.splice(s,1),i.ttl&&i.ttl<Date.now())return n.listeners.splice(s,1),!1;var a="object"===(0,_typeof3.default)(i.type)?-1!==r.indexOf(i.type,e):i.type===e;return a&&t&&n.listeners.splice(s,1),a})},this.executeListeners=function(e,t){var i=n.getListeners(e),a=i.length>1;if(i.length)if(a)s.eachSeries(i,function(e,n){e.handler.apply(e,r.concat(t,function(e){n(e||null)}))},function(e){if(e)throw e});else{if(t.length<2)return i[0].handler(t[0]);i[0].handler.apply(i[0],t)}},this.executeMiddlewares=function(e,t,i){if(!n.middlewares.length)return i();s.eachSeries(n.middlewares,function(i,s){var r=function(e){s(e||null)},a=[e,t,i.length>2?r:void 0];i.apply(n,a),2===i.length&&r()},i)},this.namespacifyAll=function(e){return r.map(e,n.namespacify)},this.namespacify=function(e){return e instanceof Namespace?e:t.namespace(e)},this.namespace=n.namespacify,this})}),t.exports=n("./index.js")}(require,module);