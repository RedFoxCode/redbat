"use strict";function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}var _promise=require("babel-runtime/core-js/promise"),_promise2=_interopRequireDefault(_promise);!function(e,t){function n(t,r){if("."!=t[0]&&"/"!=t[0])return e(t);r=r||"root";var i=n.resolve(t);if(!i&&/\.json$/i.test(t))return e("./"+n.basename(t));var s=n.cache[i];if(!s)try{return e(t)}catch(e){throw new Error('failed to require "'+t+'" from '+r+"\n"+e.message+"\n"+e.stack)}return s.exports||(s.exports={},s.call(s.exports,s,s.exports,n.relative(i))),s.exports}n.cache={},n.basename=e("path").basename,n.resolve=function(t){if("."!=t[0])return e.resolve(t);var r="/"===t.slice(-1)?t:t+"/",i=[t,t+".js",r+"index.js",t+".json",r+"index.json"];for(var s in i){var a=i[s];if(n.cache[a])return a}},n.register=function(e,t){n.cache[e]=t},n.relative=function(e){function t(t){if("."!=t[0])return n(t);var r=e.split("/"),i=t.split("/");r.pop();for(var s in i){var a=i[s];".."==a?r.pop():"."!=a&&r.push(a)}return n(r.join("/"),e)}return t.resolve=n.resolve,t.cache=n.cache,t},n.register("./eventemitter.js",function(e,t,n){var r=n("./namespace"),i=n("lodash");e.exports=function(){return this.DEFAULT_NAMESPACE="default",this.namespaces={},this.connected=[],this.namespace=function(e){return e?this.namespaces[e]?this.namespaces[e]:this.namespaces[e]=new r:this.namespaces[this.DEFAULT_NAMESPACE]},this.namespaces[this.DEFAULT_NAMESPACE]=new r,this.on=this.namespace().on,this.once=this.namespace().once,this.wait=this.namespace().wait,this.emit=function(){var e=arguments;return i.each(this.connected,function(t){return t.emit.apply(t,e)}),this.namespace().emit.apply(this,arguments)},this.use=this.namespace().use,this.listener=this.namespace().getListeners,this.pipe=function(e){this.connected.push(e)},this}}),n.register("./generator.js",function(e,t,n){var r=n("./eventemitter"),i=n("lodash");e.exports=function(){var e=this;this.methods={},this.Generator=function(){var t=this;r.apply(this),i.each(i.keys(e.methods),function(n){if(t[n])throw new Error("Method '"+n+"' already exists");t[n]=e.methods[n]})}}}),n.register("./index.js",function(e,t,n){var r=n("./eventemitter"),i=n("./generator");e.exports={EventEmitter:r,Generator:i}}),n.register("./namespace.js",function(e,t,n){var r=n("overload-js"),i=n("async"),s=n("lodash"),a=r.o;e.exports=function(){var e=this;return this.listeners=[],this.middlewares=[],this._on=function(t,n,r,i){var a,o=!i;Array.isArray(t)||(t=[t]),o&&(i=function(){a(s.slice(arguments))});var u={type:t,ttl:n?n+Date.now():null,handler:i,once:r};return e.listeners.push(u),o?new _promise2.default(function(t,n){a=function(n){t.apply(e,n)}}):e},this.on=r().args(a.any(String,Array),Function).use(function(t,n){return e._on(t,0,!1,n)}).args(a.any(String,Array),Number,Function).use(function(t,n,r){return e._on(t,n,!1,r)}),this.once=r().args(a.any(String,Array),Function).use(function(t,n){return e._on(t,0,!0,n)}).args(a.any(String,Array),Number,Function).use(function(t,n,r){return e._on(t,n,!0,r)}),this.wait=function(t,n){return e._on(t,n,!0,void 0)},this.emit=function(t,n){var r=s.slice(arguments,1);return e.executeMiddlewares(t,r,function(){e.executeListeners(t,r,function(){"function"==typeof n&&n()})}),e},this.use=function(t){return e.middlewares.push(t),e},this.getRandomID=function(){return Math.round(1e6*Math.random())},this.getListeners=function(t){return s.filter(e.listeners,function(n,r){return!!n&&(n.ttl&&n.ttl<Date.now()?(e.listeners.splice(r,1),!1):(n.once&&e.listeners.splice(r,1),-1!==s.indexOf(n.type,t)))})},this.executeListeners=function(t,n,r){var a=e.getListeners(t),o=a.length>1;if(!a.length)return r();o?i.eachSeries(a,function(e,t){e.handler.apply(e,s.concat(n,function(e){t(e||null)}))},function(e){if(e)throw e;r()}):(a[0].handler.apply(a[0],n),r())},this.executeMiddlewares=function(t,n,r){i.eachSeries(e.middlewares,function(r,i){var s=function(e){i(e||null)},a=[t,n,r.length>2?s:void 0];r.apply(e,a),2===r.length&&s()},r)},this}}),t.exports=n("./index.js")}(require,module);